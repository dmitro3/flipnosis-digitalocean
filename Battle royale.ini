Battle royale

ğŸ® 8-Player Battle Royale Mode - Complete LLM Implementation Overview
ğŸ¯ Project Goal
Create a new game mode where a creator offers their NFT as a prize, 8 players pay to compete in elimination rounds, and the last player standing wins the NFT while the creator keeps the entry fees.
ğŸ“‹ Current System (Keep Separate)
1v1 NFT vs Crypto games work perfectly - keep this system intact
May hide 1v1 temporarily but preserve all existing code
New Battle Royale mode will be completely separate game type
ğŸ†• New Battle Royale Game Mechanics
Game Setup:
Creator uploads NFT (e.g., worth $40) and sets it as prize
Entry fee: $5.50 per player ($5.00 + $0.50 service fee)
8 players join by paying entry fee
Creator is NOT a player - they're the "house"
Game Flow:
Lobby Phase: 8 slots fill as players join and pay
Round Start: Server randomly selects heads or tails, shows it flashing for 3 seconds
Flip Phase: All 8 players have 20 seconds to flip their coins (can flip simultaneously)
Auto-flip: Any player who doesn't flip gets auto-flipped at max power
Elimination: Players who landed opposite the target are eliminated
Visual Update: Eliminated players turn pink with X, remaining players stay green
Repeat: Continue until 1 player remains
Payout System:
Winner: Gets the NFT
Creator: Gets all entry fees ($40 total) minus 3.5% platform fee
Platform: Gets 3.5% of entry fees + all service fees ($4 total)
ğŸ”§ Technical Architecture
Database Schema (New Tables):


-- Battle Royale games (separate from regular games)
CREATE TABLE battle_royale_games (
  id TEXT PRIMARY KEY,
  creator TEXT NOT NULL,
  nft_contract TEXT NOT NULL,
  nft_token_id TEXT NOT NULL,
  nft_name TEXT,
  nft_image TEXT,
  entry_fee DECIMAL(20,8) NOT NULL, -- $5.00
  service_fee DECIMAL(20,8) NOT NULL, -- $0.50
  max_players INTEGER DEFAULT 8,
  current_players INTEGER DEFAULT 0,
  status TEXT DEFAULT 'filling', -- filling, active, complete, cancelled
  current_round INTEGER DEFAULT 1,
  target_result TEXT, -- Current round's target (heads/tails)
  round_deadline TIMESTAMP,
  winner_address TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Track all participants in battle royale
CREATE TABLE battle_royale_participants (
  game_id TEXT NOT NULL,
  player_address TEXT NOT NULL,
  slot_number INTEGER NOT NULL, -- 1-8, for UI positioning
  entry_paid BOOLEAN DEFAULT FALSE,
  eliminated_round INTEGER, -- NULL if still active
  final_choice TEXT, -- heads/tails for current round
  coin_result TEXT, -- what their coin landed on
  status TEXT DEFAULT 'active', -- active, eliminated, winner
  joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (game_id, player_address)
);

-- Track each round's results
CREATE TABLE battle_royale_rounds (
  id TEXT PRIMARY KEY,
  game_id TEXT NOT NULL,
  round_number INTEGER NOT NULL,
  target_result TEXT NOT NULL, -- heads or tails
  players_before INTEGER NOT NULL,
  players_eliminated INTEGER NOT NULL,
  eliminated_players TEXT, -- JSON array of addresses
  round_duration INTEGER DEFAULT 20, -- seconds
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

Smart Contract Extensions:
// Add to NFTFlipGame.sol or create new contract

struct BattleRoyaleGame {
    address creator;
    address nftContract;
    uint256 tokenId;
    uint256 entryFee;
    uint256 serviceFee;
    uint8 maxPlayers;
    uint8 currentPlayers;
    address winner;
    bool completed;
    bool creatorPaid;
    bool nftClaimed;
}

mapping(bytes32 => BattleRoyaleGame) public battleRoyaleGames;
mapping(bytes32 => mapping(address => bool)) public battleRoyaleEntries;

function createBattleRoyale(bytes32 gameId, address nftContract, uint256 tokenId, uint256 entryFee, uint256 serviceFee) external;
function joinBattleRoyale(bytes32 gameId) external payable;
function completeBattleRoyale(bytes32 gameId, address winner) external onlyOwner;
function withdrawCreatorFunds(bytes32 gameId) external;
function withdrawWinnerNFT(bytes32 gameId) external;

Server-Side Game Engine Extensions:
New GameStateManager Methods:

// Add to GameStateManager.js
createBattleRoyale(gameId, gameData) {
  // Initialize 8-player battle royale state
}

startBattleRoyaleRound(gameId) {
  // Randomly select heads/tails target
  // Set 20-second countdown
  // Broadcast to all players
}

handleBattleRoyaleFlip(gameId, playerAddress, choice, power) {
  // Process individual player flip
  // Check if all players have flipped or time expired
}

processBattleRoyaleElimination(gameId) {
  // Compare all player results to target
  // Eliminate players who got it wrong
  // Check if game is complete (1 player left)
}

Socket.io Event Handlers:

// Add to server-socketio.js
'join_battle_royale' - Handle player joining 8-player game
'battle_royale_flip' - Handle individual player coin flip
'start_battle_round' - Broadcast round start to all players
'battle_royale_elimination' - Broadcast elimination results
'battle_royale_complete' - Handle game completion

Frontend Components:
New Battle Royale Lobby:
In the lobby it still needs to have the nft details and the chat box but not the offer.
but it also has a new lobby with 8 players screen where players can join by taking a berth
// BattleRoyaleLobby.jsx
- 8 player slots in grid layout (2x4 or 1x8)
- Real-time filling as players join
- Entry fee display and payment
- Creator view (can't join own game)

New Battle Royale Game Room:
// BattleRoyaleGameRoom.jsx
- 8 player boxes across screen
- Each box shows: player address, status (active/eliminated), coin
- Target result display (heads/tails flashing)
- 20-second countdown timer
- Individual coin flip controls for each player
- Elimination animations (pink + X)

Modified Components:
// Update existing components
- Header: Add "Battle Royale" navigation option
- CreateFlip: Add toggle for 1v1 vs Battle Royale
- Routes: Add battle royale routes

ğŸ® User Experience Flow
For Creator:
Upload NFT â†’ Choose "Battle Royale" â†’ Set entry fee
Game goes live, wait for 8 players to join
Watch game progress (can't participate)
When game ends, withdraw crypto earnings
For Players:
Browse battle royale games â†’ Join open game â†’ Pay entry fee
Wait in lobby until 8 players joined
Each round: See target result â†’ Flip coin within 20 seconds
Watch eliminations â†’ Continue until winner or eliminated
If winner: Withdraw NFT
Visual Layout:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ROUND 2: TARGET IS HEADS          â° 15 SECONDS LEFT       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Player1] [Player2] [Player3] [Player4]                    â”‚
â”‚  ğŸŸ¢       ğŸŸ¢       âŒ       ğŸŸ¢                              â”‚
â”‚                                                             â”‚
â”‚ [Player5] [Player6] [Player7] [Player8]                    â”‚
â”‚  ğŸŸ¢       âŒ       ğŸŸ¢       âŒ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”§ Implementation Strategy
Phase 1: Core Battle Royale System (Week 1)
Database schema - Add battle royale tables
Smart contract - Add battle royale functions
Basic API endpoints - Create/join battle royale games
Server game engine - Battle royale state management
Phase 2: Game Flow & UI (Week 1-2)
Socket.io integration - Real-time battle royale events
Lobby component - 8-player joining interface
Game room component - 8-player elimination interface
Round progression logic - Elimination and winner detection
Phase 3: Polish & Integration
Payment integration - Entry fees and payouts
Error handling - Disconnections, timeouts, edge cases
Admin tools - Game management and recovery
Testing - Full end-to-end battle royale games
âš¡ Technical Advantages
Simultaneous flips - No turn-based complexity
Simple elimination - Binary result (in/out)
Existing coin physics - Reuse proven server-side system
Scalable architecture - Current system handles this easily
Clean separation - Doesn't interfere with 1v1 games
ğŸ’° Revenue Model
Service fees: $0.50 Ã— 8 players = $4.00 per game
Platform fee: 3.5% of $40 = $1.40 per game
Total platform revenue: $5.40 per game
Creator revenue: $40 - $1.40 = $38.60 per game
ğŸ¯ Success Metrics
Games consistently fill with 8 players
Rounds progress smoothly with 20-second timers
Eliminations work correctly (no false positives/negatives)
Payouts execute properly (creator gets crypto, winner gets NFT)
No technical issues during simultaneous coin flips
This is a completely new game mode that's actually simpler than tournament brackets - it's just elimination rounds with simultaneous coin flips. Much more straightforward to implement!

This makes much more sense and is actually easier to implement than the tournament bracket system! The simultaneous coin flipping is brilliant - no complex turn management needed.
But oibviously there is a round by round management needed but this is much less complex. 


Additionally, we also need to add the ability for a player to choose their own coin when they join, this will replace the skin on the coin much like we currently have
so right now the player chooses the coin design. but we dont need that anymore. if it's battle royale mode we dont need that. instead all coins are default unless the player chooses their own custom coin or chooses one of ours.
